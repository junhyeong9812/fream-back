spring:
  datasource:
    url: jdbc:mysql://mysql:3306/freamdb?serverTimezone=UTC
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: create  # ìš´ì˜í™˜ê²½ì€ ë³´í†µ ì§ì ‘ DDL ê´€ë¦¬
    properties:
      hibernate:
        format_sql: true
  redis:
    host: redis
    port: 6379
    # password: # ìš´ì˜ Redis ë¹„ë²ˆ
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    protocol: smtp
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
          ssl:
            trust: smtp.gmail.com
  kafka:
    bootstrap-servers: kafka:9092
    producer:
      acks: all  # ê²°ì œ ì•ˆì •ì„±ì„ ìœ„í•œ ì„¤ì •
      retries: 3
      enable-idempotence: true  # ë©±ë“±ì„± ë³´ì¥
      batch-size: 16384
      linger-ms: 5
      buffer-memory: 33554432
    consumer:
      group-id: "my-group"  # ê¸°ë³¸ ê·¸ë£¹ (ê¸°ì¡´ ViewEventìš©)
      auto-offset-reset: "earliest"
      enable-auto-commit: false  # ìˆ˜ë™ ì»¤ë°‹ (ê²°ì œ ì²˜ë¦¬ í™•ì‹¤ì„±)
      max-poll-records: 10
      fetch-min-size: 1024
      fetch-max-wait: 500
    # ê²°ì œ ê´€ë ¨ ì¶”ê°€ ì„¤ì •
    # ğŸš€ Order ì²˜ë¦¬ ê´€ë ¨ Kafka ì„¤ì • (ìˆ˜ì •ëœ ë¶€ë¶„)
    order:
      consumer:
        processing-group: "order-processing-group"    # ì£¼ë¬¸ ì²˜ë¦¬ ê·¸ë£¹
        retry-group: "order-retry-group"              # ì£¼ë¬¸ ì¬ì‹œë„ ê·¸ë£¹
        notification-group: "order-notification-group" # ì£¼ë¬¸ ì•Œë¦¼ ê·¸ë£¹
      topics:
        processing: "order-processing-topic"          # ì£¼ë¬¸ ì²˜ë¦¬ í† í”½
        retry: "order-retry-topic"                    # ì£¼ë¬¸ ì¬ì‹œë„ í† í”½
        notification: "notification-topic"            # ì•Œë¦¼ í† í”½
      retry:
        max-attempts: 3
        backoff-delay-ms: 1000
      processing:
        concurrency: 2                                # ë³‘ë ¬ ì²˜ë¦¬ ìˆ˜
        timeout-ms: 30000
    payment:
      consumer:
        processing-group: "payment-processing-group"  # ê²°ì œ ì²˜ë¦¬ ê·¸ë£¹
        retry-group: "payment-retry-group"            # ê²°ì œ ì¬ì‹œë„ ê·¸ë£¹
      topics:
        processing: "payment-processing-topic"        # ê²°ì œ ì²˜ë¦¬ í† í”½
        retry: "payment-retry-topic"                  # ê²°ì œ ì¬ì‹œë„ í† í”½
      retry:
        max-attempts: 3
        backoff-delay-ms: 1000
  elasticsearch:
    uris: http://elasticsearch:9200

  batch:
    jdbc:
      initialize-schema: never # ìš´ì˜ì—ì„  ì§ì ‘ ê´€ë¦¬

  # OAuth2 ì„¤ì • ì¶”ê°€
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: https://www.pinjun.xyz/api/login/oauth2/code/google
            scope:
              - email
              - profile
          naver:
            client-id: ${NAVER_CLIENT_ID}
            client-secret: ${NAVER_CLIENT_SECRET}
            redirect-uri: https://www.pinjun.xyz/api/login/oauth2/code/naver
            authorization-grant-type: authorization_code
            scope:
              - name
              - email
              - profile_image
            client-name: Naver
          kakao:
            client-id: ${KAKAO_CLIENT_ID}
            client-secret: ${KAKAO_CLIENT_SECRET}
            redirect-uri: https://www.pinjun.xyz/api/login/oauth2/code/kakao
            authorization-grant-type: authorization_code
            scope:
              - profile_nickname
              - profile_image
              - account_email
            client-name: Kakao
            client-authentication-method: client_secret_post
        provider:
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
kibana:
  url: https://www.pinjun.xyz/kibana

logging:
  level:
    org.hibernate.SQL: debug
    org.springframework.security: DEBUG
    com.fream: INFO  # í”„ë¡œì íŠ¸ íŒ¨í‚¤ì§€ì— ë§ê²Œ ìˆ˜ì •
    org.apache.kafka: INFO  # Kafka ë¡œê¹… ë ˆë²¨
  file:
    name: /logs/spring-app.log
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  logback:
    rollingpolicy:
      max-file-size: 10MB
      max-history: 30
      total-size-cap: 3GB

jwt:
  secret: ${JWT_SECRET}
  token-validity-in-seconds: 86400 # 24ì‹œê°„

imp:
  key: ${IMP_KEY}
  secret: ${IMP_SECRET}
  pg: ${IMP_PG} # PGì‚¬ì™€ ê°€ë§¹ì  ID
  storeId: ${IMP_STOREID}

personal-data:
  encryption:
    secret-key: ${PERSONAL_ENCRYPTION_KEY}
    iv: ${PERSONAL_ENCRYPTION_IV}

openai:
  api:
    key: ${OPENAPI_KEY}  # ì‹¤ì œ API í‚¤ë¡œ ëŒ€ì²´ í•„ìš”
    url: https://api.openai.com/v1/chat/completions
  model: gpt-3.5-turbo

server:
  use-forward-headers: true

# ê²°ì œ ë„ë©”ì¸ ê´€ë ¨ ì„¤ì • ì¶”ê°€
payment:
  encryption:
    # ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ìš© í•˜ë“œì½”ë”© ì•”í˜¸í™” í‚¤ (ì‹¤ì œ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ êµì²´ í•„ìš”)
    secret-key: "dev_payment_encryption_secret_key_12345"
    salt: "dev_payment_salt_value_for_testing_only"
    iv: "dev0123456789abc" # ì´ˆê¸°í™” ë²¡í„°ëŠ” 16ë°”ì´íŠ¸
  card-info:
    max-count: 5 # ì‚¬ìš©ìë‹¹ ìµœëŒ€ ë“±ë¡ ê°€ëŠ¥í•œ ì¹´ë“œ ì •ë³´ ìˆ˜
  retry:
    max-attempts: 3 # ê²°ì œ ì‹¤íŒ¨ ì‹œ ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜
    delay-ms: 1000 # ì¬ì‹œë„ ê°„ê²© (ë°€ë¦¬ì´ˆ)
  logging:
    mask-sensitive-data: true # ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹ í™œì„±í™” ì—¬ë¶€
  api:
    timeout: 10000 # ì™¸ë¶€ API í˜¸ì¶œ íƒ€ì„ì•„ì›ƒ (ë°€ë¦¬ì´ˆ)
  # Kafka ê²°ì œ ì²˜ë¦¬ ê´€ë ¨ ì„¤ì •
  kafka:
    enabled: true  # Kafka ê²°ì œ ì²˜ë¦¬ í™œì„±í™” ì—¬ë¶€
    topics:
      processing: "payment-processing-topic"
      retry: "payment-retry-topic"
    consumer:
      processing-group: "payment-processing-group"
      retry-group: "payment-retry-group"
      concurrency: 1  # ë™ì‹œ ì²˜ë¦¬ ìˆ˜ (ê²°ì œëŠ” ìˆœì°¨ ì²˜ë¦¬ ê¶Œì¥)
    producer:
      timeout-ms: 5000
    retry:
      max-attempts: 3
      backoff-multiplier: 2
      initial-delay-ms: 1000

# weather ë„ë©”ì¸ ì„¤ì •
weather:
  api:
    url: https://api.open-meteo.com/v1/forecast
    params:
      latitude: 36.5
      longitude: 127.75
      hourly: temperature_2m,precipitation_probability,precipitation,rain,snowfall
      timezone: auto
  scheduler:
    # 24ì‹œê°„(86400000 ë°€ë¦¬ì´ˆ) ê°„ê²©ìœ¼ë¡œ ê°±ì‹ 
    interval: 86400000
    # ì´ˆê¸° ì§€ì—° ì‹œê°„ (ì„œë²„ ì‹œì‘ í›„ 10ì´ˆ ëŒ€ê¸°)
    initial-delay: 10000
  data:
    # í•œ ë²ˆì— ì²˜ë¦¬í•  ì‹œê°„ ê°œìˆ˜ (48ì‹œê°„)
    hours-count: 48

# AccessLog ë„ë©”ì¸ ì„¤ì •
access-log:
  use-kafka: false  # falseë¡œ ì„¤ì •í•˜ì—¬ ì§ì ‘ DBì— ì €ì¥
  geoip:
    database-path: classpath:GeoLite2-City.mmdb
  kafka:
    topic: user-access-log-topic
    group-id: user-access-log-group